services:
  # Combined Frontend + Backend Service (Cost-Effective - Single Service!)
  - type: web
    name: voice-agent-app
    runtime: python
    buildCommand: |
      # Install backend dependencies
      cd openai-voice-agent-sdk-sample/server && pip install -e . &&
      # Install Node.js 18
      curl -fsSL https://deb.nodesource.com/setup_18.x | sudo bash - &&
      sudo apt-get install -y nodejs &&
      # Build frontend static files
      cd ../frontend && npm install && npm run export
    startCommand: cd openai-voice-agent-sdk-sample && python combined_server.py
    plan: starter
    envVars:
      - key: OPENAI_API_KEY
        sync: false
      - key: PYTHON_VERSION
        value: 3.11.0
    rootDir: .
